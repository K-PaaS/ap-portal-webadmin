<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorator="../layout/default">
<head></head>
<body>
<div>
    <header></header>
    <aside>/</aside>
    <!-- Content Wrapper. Contains page content -->
    <div layout:fragment="content" class="content-wrapper">
        <!-- tabNumber hidden value :: tabs -->
        <input type="hidden" id="tabName" value="STARTER"/>
        <!-- Content Header (Page header) -->
        <section class="content-header">
            <h1>
                카탈로그 관리
            </h1>
        </section>
        <!-- Main content -->
        <section class="content">
            <div class="row">
                <div class="col-xs-12">
                    <div class="box-header">
                        <!-- create button box -->
                        <div class="box-title">
                            <button th:type="button" class="btn btn-block btn-primary btn-sm" onclick="procMoveForm()"
                                    id="btn_insert">앱 템플릿 등록
                            </button>
                        </div>
                        <!-- Search a box -->
                        <div class="input-group input-group-sm pull-right header" style="width: 300px;">
                            <input type="text" id="searchKeyword" class="form-control pull-right" placeholder="Search"
                                   onkeyup="getSearchList(event);"/>
                            <div class="input-group-btn">
                                <button type="button" id="btnSearch" class="btn btn-default"><i
                                        class="fa fa-search"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <br/><br/>

                <div class="col-xs-12">
                    <div class="box">
                        <!-- 탭 구현설정1 -->
                        <div class="nav-tabs-custom" style="cursor: move;">
                            <!-- Tabs box -->
                            <ul class="nav nav-tabs pull-right ui-sortable-handle">
                                <!-- chart - 03 -->
                                <li id="SERVICE_PACK"><a href="#SERVICE_PACK_TAB" data-toggle="tab"
                                                         aria-expanded="false"
                                                         onclick="appbutton('SERVICE_PACK')">
                                    <i class="fa fa-fw fa-gear"></i>앱 서비스</a></li>
                                <!-- chart - 02 -->
                                <li id="DEVELOP_PACK"><a href="#DEVELOP_PACK_TAB" data-toggle="tab"
                                                         onclick="appbutton('DEVELOP_PACK')"
                                                         aria-expanded="false">
                                    <i class="fa fa-fw fa-code-fork"></i>앱 개발환경</a></li>
                                <!-- chart - 01-->
                                <li id="STARTER"><a href="#STARTER_TAB" data-toggle="tab"
                                                    aria-expanded="true"
                                                    onclick="appbutton('STARTER')">
                                    <i class="fa fa-fw fa-bookmark-o"></i>앱 템플릿</a></li>
                            </ul>

                            <div class="tab-content no-padding">
                                <!-- chart - 01 -->
                                <div class="chart tab-pane active" id="STARTER_TAB"
                                     style="position: relative; height: 600px; -webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
                                    <div id="starterListMessageArea" class="table-responsive">
                                        <table class="table table-striped">
                                            <tr>
                                                <th style="width: 10px">#</th>
                                                <th>이름</th>
                                                <th>요약</th>
                                                <th>분류</th>
                                                <th>공개</th>
                                            </tr>
                                            <tbody id="starterListTableArea">
                                            </tbody>
                                        </table>
                                        <!--<div class="box-footer clearfix"></div>-->
                                    </div>
                                    <form id="starterHiddenForm">
                                        <input type="hidden" id="starterHiddenFormNo" name="no" value=""/>
                                    </form>
                                </div>
                                <!-- chart - 02 -->
                                <div class="chart tab-pane" id="DEVELOP_PACK_TAB"
                                     style="position: relative; height: 600px; -webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
                                    <div id="buildPackMessageArea" class="table-responsive">
                                        <table class="table table-striped">
                                            <tr>
                                                <th style="width: 10px">#</th>
                                                <th>이름</th>
                                                <th>요약</th>
                                                <th>분류</th>
                                                <th>공개</th>
                                            </tr>
                                            <tbody id="buildPackTableArea">
                                            </tbody>
                                        </table>
                                        <!--<div class="box-footer clearfix"></div>-->
                                        <form id="BuildPackHiddenForm">
                                            <input type="hidden" id="BuildPackHiddenFormNo" name="no" value=""/>
                                        </form>
                                    </div>
                                </div>
                                <!-- chart - 03 -->
                                <div class="chart tab-pane" id="SERVICE_PACK_TAB"
                                     style="position: relative; height: 600px; -webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
                                    <div id="servicePackMessageArea" class="table-responsive">
                                        <table class="table table-striped">
                                            <tr>
                                                <th style="width: 10px">#</th>
                                                <th>이름</th>
                                                <th>요약</th>
                                                <th>분류</th>
                                                <th>공개</th>
                                            </tr>
                                            <tbody id="servicePackTableArea">
                                            </tbody>
                                        </table>
                                        <!--<div class="box-footer clearfix"></div>-->
                                    </div>
                                    <form id="ServicePackHiddenForm">
                                        <input type="hidden" id="ServicePackHiddenFormNo" name="no" value=""/>
                                    </form>
                                </div>
                                <!-- ▼ <div class="tab-content no-padding">-->
                            </div>
                            <!-- ▼ tab class end -->
                        </div>
                        <!-- ▼row: 12   <div class="tab-content no-padding">-->
                    </div>
                </div>
            </div>
        </section>
        <!-- /.content -->
    </div>
    <!-- /.content-wrapper -->
    <footer></footer>
</div>
<!-- ./wrapper -->

<script th:inline="javascript" type="text/javascript" layout:fragment="custom-script">
    /*<![CDATA[*/
    var STARTER_LIST_PROC_URL = "/v2/starterpacks";
    var STARTER_INSERT_FORM_URL = "/starterpackForm";
    var DEVELOP_PACK_LIST_PROC_URL = "/v2/developpacks";
    var DEVELOP_PACK_INSERT_FORM_URL = "/developpackForm";
    var SERVICE_PACK_LIST_PROC_URL = "/v2/servicepacks";
    var SERVICE_PACK_INSERT_FORM_URL = "/servicepackForm";
    var CLIENT_LIST = new Array();
    var TAB_NAME = /*[[${TAB_NAME}]]*/ null;
    var STARTER_PACK = /*[[${T(org.openpaas.paasta.portal.web.admin.common.Constants).TAB_NAME_STARTER}]]*/ null;
    var DEVELOP_PACK = /*[[${T(org.openpaas.paasta.portal.web.admin.common.Constants).TAB_NAME_DEVELOP_PACK}]]*/ null;
    var SERVICE_PACK = /*[[${T(org.openpaas.paasta.portal.web.admin.common.Constants).TAB_NAME_SERVICE_PACK}]]*/ null;


    //  procGetSearchList
    $(document.body).ready(function () {
        getStarterList();
        getBuildPackList();
        getServicePackList();

        if (TAB_NAME != null) {
            $("#" + STARTER_PACK + "_TAB").removeClass('active');
            $("#" + DEVELOP_PACK + "_TAB").removeClass('active');
            $("#" + SERVICE_PACK + "_TAB").removeClass('active');
            $("#" + TAB_NAME).addClass('active');
            $("#" + TAB_NAME + "_TAB").addClass('active');
            appbutton(TAB_NAME);
        } else {
            $("#STARTER").addClass('active');
        }

    });

    getSearchList = function () {
        getStarterList();
        getBuildPackList();
        getServicePackList();
    }


    // CHECK SEARCH FORM KEY EVENT
    var procCheckSearchFormKeyEvent = function (e) {
        if (e.keyCode == 13 && e.srcElement.type != 'textarea') {
            procGetSearchList();
        }
    };

    function procSearchByKeyword(event) {

        $('#starterListTableArea').hide(); //<tbody id> 값
        $('#starterList').empty();

        var searchKeyword = document.getElementById('searchKeyword').value;
        var searchResult = new Array();
        var newIdx = 0;
        for (var i = 0; i < CLIENT_LIST.length; i++) {

            if (CLIENT_LIST[i].includes(document.getElementById('searchKeyword').value)) {
                searchResult[newIdx++] = CLIENT_LIST[i];
            }
        }

        CURRENT_LIST = searchResult;
        var reqParam = {'searchKeyword': searchKeyword};
        getStarterList(reqParam);
    }

    // BIND :: BUTTON EVENT
    $("#btnSearch").on("click", function () {
        procGetSearchList();

    });

    // GET StarterList
    var getStarterList = function () {
        var doc = document;
        var searchKeyword = document.getElementById('searchKeyword').value;
        var param = "";
        if (null != searchKeyword && "" != searchKeyword) {
            param = {"searchKeyword": searchKeyword};
        }
        procCallAjax2(STARTER_LIST_PROC_URL, "GET", param, procCallbackGetStarterList);
    };

    // GET BuildPackList
    var getBuildPackList = function (reqParam) {
        var doc = document;
        var searchKeyword = document.getElementById('searchKeyword').value;
        var param = "";
        if (null != searchKeyword && "" != searchKeyword) {
            param = {"searchKeyword": searchKeyword};
        }
        procCallAjax2(DEVELOP_PACK_LIST_PROC_URL, "GET", param, procCallbackGetBuildPackList);
    };

    // GET ServicePackList
    var getServicePackList = function (reqParam) {
        var doc = document;
        var searchKeyword = document.getElementById('searchKeyword').value;
        var param = "";
        if (null != searchKeyword && "" != searchKeyword) {
            param = {"searchKeyword": searchKeyword};
        }
        procCallAjax2(SERVICE_PACK_LIST_PROC_URL, "GET", param, procCallbackGetServicePackList);

    };

    // GET LIST CALLBACK StarterList
    var procCallbackGetStarterList = function (data) {
        var objTable = $("#starterList");
        var objTableArea = $('#starterListTableArea');
        var objMessageArea = $('#starterListMessageArea');
        var listLength = data.list.length;
        var htmlString = [];

        objTableArea.html('');

        if (listLength < 1) {
            objMessageArea.append('<spring:message code="common.info.empty.data" />');
            objMessageArea.show();

        } else {
            var catalogList = data.list;

            for (var i = 0; i < listLength; i++) {
//                reqParam = {name: catalogList[i].name};
                htmlString.push('<tr style="cursor:pointer;" onclick="procMoveStarterInsertForm(\'' + catalogList[i].no + '\')">'
                    + '<td>' + (i + 1) + '</td>'
                    + '<td>' + catalogList[i].name + '</td>'
                    + '<td>' + catalogList[i].summary + '</td>'
                    + '<td>' + catalogList[i].classificationValue + '</td>'
                    + '<td><span class="label label-danger">' + catalogList[i].useYn + '</span></td>'
                    + '</tr>');
            }

            objTableArea.append(htmlString).trigger("create");
        }
    };

    // GET LIST CALLBACK BuildPackList
    var procCallbackGetBuildPackList = function (data) {
        var objTable = $('#buildPackListTable');
        var objTableArea = $('#buildPackTableArea');
        var objMessageArea = $('#buildPackMessageArea');
        var listLength = data.list.length;
        var htmlString = [];

        objTableArea.html('');

        if (listLength < 1) {
            objMessageArea.append('<spring:message code="common.info.empty.data" />');
            objMessageArea.show();

        } else {
            var catalogList = data.list;

            for (var i = 0; i < listLength; i++) {
                htmlString.push('<tr style="cursor:pointer;" onclick="procMoveBuildPackInsertForm(\'' + catalogList[i].no + '\')">'
                    + '<td>' + (i + 1) + '</td>'
                    + '<td>' + catalogList[i].name + '</td>'
                    + '<td>' + catalogList[i].summary + '</td>'
                    + '<td>' + catalogList[i].classificationValue + '</td>'
                    + '<td><span class="label label-danger">' + catalogList[i].useYn + '</span></td>'
                    + '</tr>');
            }
            objTableArea.append(htmlString).trigger("create");
        }
    };

    // GET LIST CALLBACK ServicePackList
    var procCallbackGetServicePackList = function (data) {
        var objTable = $('#servicePackListTable');
        var objTableArea = $('#servicePackTableArea');
        var objMessageArea = $('#servicePackMessageArea');
        var listLength = data.list.length;
        var htmlString = [];

        objTableArea.html('');

        if (listLength < 1) {
            objMessageArea.append('<spring:message code="common.info.empty.data" />');
            objMessageArea.show();

        } else {
            var catalogList = data.list;

            for (var i = 0; i < listLength; i++) {
                htmlString.push('<tr style="cursor:pointer;" onclick="procMoveServicePackInsertForm(\'' + catalogList[i].no + '\')">'
                    + '<td>' + (i + 1) + '</td>'
                    + '<td>' + catalogList[i].name + '</td>'
                    + '<td>' + catalogList[i].summary + '</td>'
                    + '<td>' + catalogList[i].classificationValue + '</td>'
                    + '<td><span class="label label-danger">' + catalogList[i].useYn + '</span></td>'
                    + '</tr>');
            }
            objTableArea.append(htmlString).trigger("create");
        }
    };

    // MOVE PAGE StarterInsertForm
    var procMoveStarterInsertForm = function (reqParam) {
        var hiddenForm = $('#starterHiddenForm');
        $('#starterHiddenFormNo').val(reqParam);
        hiddenForm.attr({action: STARTER_INSERT_FORM_URL, method: "POST"}).submit();
    };

    // MOVE PAGE BuildPackInsertForm
    var procMoveBuildPackInsertForm = function (reqParam) {
        var hiddenForm = $('#BuildPackHiddenForm');
        $('#BuildPackHiddenFormNo').val(reqParam);
        hiddenForm.attr({action: DEVELOP_PACK_INSERT_FORM_URL, method: "POST"}).submit();
    };

    // MOVE PAGE ServicePackInsertForm
    var procMoveServicePackInsertForm = function (reqParam) {
        var hiddenForm = $('#ServicePackHiddenForm');
        $('#ServicePackHiddenFormNo').val(reqParam);
        hiddenForm.attr({action: SERVICE_PACK_INSERT_FORM_URL, method: "POST"}).submit();
    };

    // MOVE PAGE Button Form
    var appbutton = function (tabName) {
        $("#btn_insert").text("");
        if (tabName == SERVICE_PACK) {
            $("#btn_insert").text("서비스 등록");
        } else if (tabName == DEVELOP_PACK) {
            $("#btn_insert").text("앱 개발환경 등록");

        } else if (tabName == STARTER_PACK) {
            $("#btn_insert").text("앱 템플릿 등록");
        }
        $("#tabName").val(tabName);
    }

    // MOVE TabForm
    var procMoveForm = function () {

        var tabName = $("#tabName").val();

        if (tabName == STARTER_PACK) {
            procMovePage(STARTER_INSERT_FORM_URL);
        } else if (tabName == DEVELOP_PACK) {
            procMovePage(DEVELOP_PACK_INSERT_FORM_URL);
        } else if (tabName == SERVICE_PACK) {
            procMovePage(SERVICE_PACK_INSERT_FORM_URL);
        }
    }
    /*]]>*/
</script>

</body>
</html>
